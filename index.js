const express = require('express')
const app = express()

const {
    createCanvas,
    Image
} = require('canvas');

function adjust(col, amt) {
        col = col.replace(/^#/, '')
        if (col.length === 3) col = col[0] + col[0] + col[1] + col[1] + col[2] + col[2]
      
        let [r, g, b] = col.match(/.{2}/g);
        ([r, g, b] = [parseInt(r, 16) + amt, parseInt(g, 16) + amt, parseInt(b, 16) + amt])
      
        r = Math.max(Math.min(255, r), 0).toString(16)
        g = Math.max(Math.min(255, g), 0).toString(16)
        b = Math.max(Math.min(255, b), 0).toString(16)
      
        const rr = (r.length < 2 ? '0' : '') + r
        const gg = (g.length < 2 ? '0' : '') + g
        const bb = (b.length < 2 ? '0' : '') + b
      
        return `#${rr}${gg}${bb}`
    // return '#' + color?.replace(/^#/, '')?.replace(/../g, color => ('0' + Math.min(255, Math.max(0, parseInt(color, 16) + amount)).toString(16)).substr(-2));
}

const stringToColor = (str) => {
    let hash = 0;
    for (var i = 0; i < str?.length; i++) {
        hash = str.charCodeAt(i) + ((hash << 5) - hash);
    }
    let colour = '#';
    for (let i = 0; i < 3; i++) {
        let value = (hash >> (i * 8)) & 0xFF;
        colour += ('00' + value.toString(16)).substr(-2);
    }
    return colour;
}

const pickTextColorBasedOnBgColorAdvanced = function(bgColor) {
    let color = (bgColor.charAt(0) === '#') ? bgColor.substring(1, 7) : bgColor;
    let r = parseInt(color.substring(0, 2), 16); // hexToR
    let g = parseInt(color.substring(2, 4), 16); // hexToG
    let b = parseInt(color.substring(4, 6), 16); // hexToB
    let uicolors = [r / 255, g / 255, b / 255];
    let c = uicolors.map((col) => {
      if (col <= 0.03928) {
        return col / 12.92;
      }
      return Math.pow((col + 0.055) / 1.055, 2.4);
    });
    let L = (0.2126 * c[0]) + (0.7152 * c[1]) + (0.0722 * c[2]);
    return (L > 0.179) ? '#000' : '#fff';
}

function hexToHSL(hex, name) { 
    var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
      r = parseInt(result[1], 16);
      g = parseInt(result[2], 16);
      b = parseInt(result[3], 16);
      r /= 255, g /= 255, b /= 255;
      var max = Math.max(r, g, b), min = Math.min(r, g, b);
      var h, s, l = (max + min) / 2;
      if(max == min){
        h = s = 0; // achromatic
      }else{
        var d = max - min;
        s = l > 0.5 ? d / (2 - max - min) : d / (max + min);
        switch(max){
          case r: h = (g - b) / d + (g < b ? 6 : 0); break;
          case g: h = (b - r) / d + 2; break;
          case b: h = (r - g) / d + 4; break;
        }
        h /= 6;
      }
    var HSL = new Object();
    HSL['h']= Math.floor(h * 100) + name.length;
    HSL['s']= Math.floor(s * 100) + name.length;
    HSL['l']= 90
    return `hsl(${HSL['h']}, ${HSL['s']}% ${HSL['l']}%)`;
}

app.get('/', function (req, res) {
    res.send('Hello World')
})

app.get('/image', (req, res) => {
    const name = req.query.name.split(' ').map(word => word[0]).join('').slice(0, 2);
    const _bg = stringToColor(Buffer.from(req.query.name, 'base64').toString('base64url'));
    const _color = adjust(_bg, 0);
    const HSLja = hexToHSL(_color, Buffer.from(req.query.name, 'base64').toString('base64url'));
    const FONT_COLOR = '#000';
    const DATA_SVG = [
        `<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M188.941 100C192.769 100 196.477 99.4861 200 98.5234C197.199 97.9327 194.295 97.622 191.319 97.622H141.855C133.685 97.622 126.061 95.2811 119.619 91.2334C121.027 82.9896 124.913 75.0866 131.277 68.7229L162.891 37.1094C165.598 34.4024 167.856 31.4169 169.667 28.2452C167.268 29.8079 164.995 31.6416 162.891 33.7463L127.914 68.7229C122.137 74.4999 115.091 78.2351 107.674 79.9285C102.84 73.1033 100 64.7671 100 55.7675V11.0593C100 7.23107 99.4861 3.5229 98.5234 0C97.9327 2.80071 97.622 5.70466 97.622 8.68118L97.622 58.1456C97.622 66.3155 95.2811 73.9388 91.2335 80.3812C82.9897 78.9727 75.0866 75.0865 68.7229 68.7228L37.1094 37.1094C34.4024 34.4024 31.4169 32.1437 28.2452 30.3334C29.8079 32.7315 31.6416 35.0047 33.7463 37.1094L68.7229 72.086C74.4999 77.8631 78.2352 84.9088 79.9285 92.3263C73.1033 97.1596 64.7671 100 55.7675 100H11.0593C7.23105 100 3.52289 100.514 0 101.477C2.80073 102.067 5.70469 102.378 8.68122 102.378H58.1456C66.3156 102.378 73.9388 104.719 80.3812 108.767C78.9727 117.01 75.0866 124.913 68.7229 131.277L37.1094 162.891C34.4025 165.598 32.1438 168.583 30.3335 171.755C32.7316 170.192 35.0047 168.358 37.1094 166.254L72.086 131.277C77.863 125.5 84.9088 121.765 92.3263 120.071C97.1596 126.897 100 135.233 100 144.233V188.941C100 192.769 100.514 196.477 101.477 200C102.067 197.199 102.378 194.295 102.378 191.319V141.854C102.378 133.684 104.719 126.061 108.767 119.619C117.01 121.027 124.913 124.913 131.277 131.277L162.891 162.891C165.598 165.598 168.583 167.856 171.755 169.667C170.192 167.268 168.358 164.995 166.254 162.891L131.277 127.914C125.5 122.137 121.765 115.091 120.072 107.674C126.897 102.84 135.233 100 144.233 100H188.941Z" fill="${FONT_COLOR}"/>
        </svg>
        `,
        `<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" class="iconify iconify--bi" width="250" height="250" preserveAspectRatio="xMidYMid meet" viewBox="0 0 16 16"><path fill="currentColor" d="M6.174 1.184a2 2 0 0 1 3.652 0A2 2 0 0 1 12.99 3.01a2 2 0 0 1 1.826 3.164a2 2 0 0 1 0 3.652a2 2 0 0 1-1.826 3.164a2 2 0 0 1-3.164 1.826a2 2 0 0 1-3.652 0A2 2 0 0 1 3.01 12.99a2 2 0 0 1-1.826-3.164a2 2 0 0 1 0-3.652A2 2 0 0 1 3.01 3.01a2 2 0 0 1 3.164-1.826zM8 1a1 1 0 0 0-.998 1.03l.01.091c.012.077.029.176.054.296c.049.241.122.542.213.887c.182.688.428 1.513.676 2.314L8 5.762l.045-.144c.248-.8.494-1.626.676-2.314c.091-.345.164-.646.213-.887a4.997 4.997 0 0 0 .064-.386L9 2a1 1 0 0 0-1-1zM2 9l.03-.002l.091-.01a4.99 4.99 0 0 0 .296-.054c.241-.049.542-.122.887-.213a60.59 60.59 0 0 0 2.314-.676L5.762 8l-.144-.045a60.59 60.59 0 0 0-2.314-.676a16.705 16.705 0 0 0-.887-.213a4.99 4.99 0 0 0-.386-.064L2 7a1 1 0 1 0 0 2zm7 5l-.002-.03a5.005 5.005 0 0 0-.064-.386a16.398 16.398 0 0 0-.213-.888a60.582 60.582 0 0 0-.676-2.314L8 10.238l-.045.144c-.248.8-.494 1.626-.676 2.314c-.091.345-.164.646-.213.887a4.996 4.996 0 0 0-.064.386L7 14a1 1 0 1 0 2 0zm-5.696-2.134l.025-.017a5.001 5.001 0 0 0 .303-.248c.184-.164.408-.377.661-.629A60.614 60.614 0 0 0 5.96 9.23l.103-.111l-.147.033a60.88 60.88 0 0 0-2.343.572c-.344.093-.64.18-.874.258a5.063 5.063 0 0 0-.367.138l-.027.014a1 1 0 1 0 1 1.732zM4.5 14.062a1 1 0 0 0 1.366-.366l.014-.027c.01-.02.021-.048.036-.084a5.09 5.09 0 0 0 .102-.283c.078-.233.165-.53.258-.874a60.6 60.6 0 0 0 .572-2.343l.033-.147l-.11.102a60.848 60.848 0 0 0-1.743 1.667a17.07 17.07 0 0 0-.629.66a5.06 5.06 0 0 0-.248.304l-.017.025a1 1 0 0 0 .366 1.366zm9.196-8.196a1 1 0 0 0-1-1.732l-.025.017a4.951 4.951 0 0 0-.303.248a16.69 16.69 0 0 0-.661.629A60.72 60.72 0 0 0 10.04 6.77l-.102.111l.147-.033a60.6 60.6 0 0 0 2.342-.572c.345-.093.642-.18.875-.258a4.993 4.993 0 0 0 .367-.138a.53.53 0 0 0 .027-.014zM11.5 1.938a1 1 0 0 0-1.366.366l-.014.027c-.01.02-.021.048-.036.084a5.09 5.09 0 0 0-.102.283c-.078.233-.165.53-.258.875a60.62 60.62 0 0 0-.572 2.342l-.033.147l.11-.102a60.848 60.848 0 0 0 1.743-1.667c.252-.253.465-.477.629-.66a5.001 5.001 0 0 0 .248-.304l.017-.025a1 1 0 0 0-.366-1.366zM14 9a1 1 0 0 0 0-2l-.03.002a4.996 4.996 0 0 0-.386.064c-.242.049-.543.122-.888.213c-.688.182-1.513.428-2.314.676L10.238 8l.144.045c.8.248 1.626.494 2.314.676c.345.091.646.164.887.213a4.996 4.996 0 0 0 .386.064L14 9zM1.938 4.5a1 1 0 0 0 .393 1.38l.084.035c.072.03.166.064.283.103c.233.078.53.165.874.258a60.88 60.88 0 0 0 2.343.572l.147.033l-.103-.111a60.584 60.584 0 0 0-1.666-1.742a16.705 16.705 0 0 0-.66-.629a4.996 4.996 0 0 0-.304-.248l-.025-.017a1 1 0 0 0-1.366.366zm2.196-1.196l.017.025a4.996 4.996 0 0 0 .248.303c.164.184.377.408.629.661A60.597 60.597 0 0 0 6.77 5.96l.111.102l-.033-.147a60.602 60.602 0 0 0-.572-2.342c-.093-.345-.18-.642-.258-.875a5.006 5.006 0 0 0-.138-.367l-.014-.027a1 1 0 1 0-1.732 1zm9.928 8.196a1 1 0 0 0-.366-1.366l-.027-.014a5 5 0 0 0-.367-.138c-.233-.078-.53-.165-.875-.258a60.619 60.619 0 0 0-2.342-.572l-.147-.033l.102.111a60.73 60.73 0 0 0 1.667 1.742c.253.252.477.465.66.629a4.946 4.946 0 0 0 .304.248l.025.017a1 1 0 0 0 1.366-.366zm-3.928 2.196a1 1 0 0 0 1.732-1l-.017-.025a5.065 5.065 0 0 0-.248-.303a16.705 16.705 0 0 0-.629-.661A60.462 60.462 0 0 0 9.23 10.04l-.111-.102l.033.147a60.6 60.6 0 0 0 .572 2.342c.093.345.18.642.258.875a4.985 4.985 0 0 0 .138.367a.575.575 0 0 0 .014.027zM8 9.5a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3z"></path></svg>`,
        `<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M99.9942 183.711C106.781 191.856 113.567 200 127.14 200C158.384 200 167.409 158.444 167.421 127.156C167.421 113.584 175.565 106.798 183.71 100.012C191.855 93.2255 200 86.4395 200 72.8675C200 41.6139 158.384 32.5774 127.151 32.5774C113.579 32.5774 106.792 24.4331 100.006 16.2887C93.2194 8.14435 86.433 0 72.8602 0C41.6048 0 32.5678 41.6139 32.5678 72.8445C32.5678 86.4165 24.4259 93.2025 16.2839 99.9885C8.14196 106.775 0 113.561 0 127.133C0 158.386 41.6048 167.423 72.8487 167.423C86.4215 167.423 93.2079 175.567 99.9942 183.711ZM100 137C120.435 137 137 120.435 137 100C137 79.5655 120.435 63 100 63C79.5655 63 63 79.5655 63 100C63 120.435 79.5655 137 100 137Z" fill="${FONT_COLOR}"/>
        </svg>
        `,
        `<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M169.909 139.373C161.736 129.94 160.408 115.21 165.832 103.97C170.425 94.452 173 83.7766 173 72.5C173 32.4594 140.541 0 100.5 0C60.4594 0 28 32.4594 28 72.5C28 83.522 30.4596 93.9695 34.8598 103.324C40.1723 114.617 38.6997 129.334 30.4352 138.686C20.1832 150.288 12.7935 164.478 9.37176 180.151C7.01575 190.942 16.1944 200 27.2401 200H172.503C183.549 200 192.728 190.943 190.372 180.151C187.017 164.786 179.849 150.845 169.909 139.373Z" fill="${FONT_COLOR}"/>
        </svg>
        `,
        `<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M100 200C91.6667 200 84.7222 197.309 79.1667 191.927C73.6111 186.545 70.8333 180.035 70.8333 172.396C70.8333 168.056 71.7014 164.149 73.4375 160.677C75.1736 157.205 78.2118 153.385 82.5521 149.219C87.066 145.052 90.625 141.146 93.2292 137.5C96.0069 133.681 97.3958 130.382 97.3958 127.604V118.229C93.5764 117.361 90.191 115.625 87.2396 113.021C84.4618 110.243 82.6389 106.944 81.7708 103.125H72.3958C69.4444 103.125 65.9722 104.514 61.9792 107.292C57.9861 110.069 54.1667 113.455 50.5208 117.448C46.875 121.441 43.2292 124.392 39.5833 126.302C36.1111 128.212 32.1181 129.167 27.6042 129.167C19.7917 129.167 13.1944 126.389 7.8125 120.833C2.60417 115.278 0 108.333 0 100C0 91.6667 2.60417 84.7222 7.8125 79.1667C13.1944 73.6111 19.7917 70.8333 27.6042 70.8333C34.8958 70.8333 41.1458 73.4375 46.3542 78.6458C51.5625 83.8542 56.25 88.2812 60.4167 91.9271C64.5833 95.5729 68.5764 97.3958 72.3958 97.3958H81.7708C82.6389 93.4028 84.4618 90.1041 87.2396 87.5C90.191 84.7222 93.5764 82.9861 97.3958 82.2916V72.9167C97.3958 68.4028 93.9236 62.6736 86.9792 55.7292L81.5104 50.2604C74.3924 43.1424 70.8333 35.5903 70.8333 27.6042C70.8333 19.7917 73.6111 13.2812 79.1667 8.07291C84.8958 2.69097 91.8403 0 100 0C108.333 0 115.278 2.69097 120.833 8.07291C126.389 13.4549 129.167 19.9653 129.167 27.6042C129.167 36.4583 124.826 44.7917 116.146 52.6042C107.465 60.5903 103.125 67.3611 103.125 72.9167V82.2916C107.118 82.9861 110.417 84.7222 113.021 87.5C115.799 90.1041 117.535 93.4028 118.229 97.3958H127.604C133.507 97.3958 140.278 92.9687 147.917 84.1146C155.729 75.2604 163.889 70.8333 172.396 70.8333C180.208 70.8333 186.719 73.6979 191.927 79.4271C197.309 84.9826 200 91.8403 200 100C200 108.333 197.309 115.278 191.927 120.833C186.545 126.389 180.035 129.167 172.396 129.167C165.104 129.167 158.941 126.649 153.906 121.615C148.872 116.58 144.184 112.24 139.844 108.594C135.503 104.948 131.424 103.125 127.604 103.125H118.229C116.84 111.458 111.806 116.493 103.125 118.229V127.604C103.125 132.812 107.465 139.497 116.146 147.656C124.826 155.816 129.167 164.062 129.167 172.396C129.167 180.208 126.302 186.719 120.573 191.927C115.017 197.309 108.16 200 100 200Z" fill="${FONT_COLOR}"/>
        </svg>
        `,
        `<svg viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M165.963 134.037C160.496 139.504 151.631 139.504 146.164 134.037L122.027 109.899C116.559 104.432 116.559 95.5678 122.027 90.1005L146.164 65.9631C151.631 60.4957 160.496 60.4957 165.963 65.9631L190.101 90.1004C195.568 95.5678 195.568 104.432 190.101 109.899L165.963 134.037ZM53.8359 134.037C48.3686 139.504 39.5042 139.504 34.0369 134.037L9.89952 109.899C4.43218 104.432 4.43217 95.5678 9.89951 90.1005L34.0369 65.9631C39.5042 60.4957 48.3686 60.4957 53.8359 65.9631L77.9733 90.1004C83.4406 95.5678 83.4406 104.432 77.9733 109.899L53.8359 134.037ZM109.9 190.1C104.432 195.568 95.5679 195.568 90.1005 190.1L65.9631 165.963C60.4958 160.496 60.4958 151.631 65.9631 146.164L90.1005 122.027C95.5679 116.559 104.432 116.559 109.9 122.027L134.037 146.164C139.504 151.631 139.504 160.496 134.037 165.963L109.9 190.1ZM109.9 77.9732C104.432 83.4405 95.5679 83.4406 90.1005 77.9732L65.9631 53.8358C60.4958 48.3685 60.4958 39.5042 65.9631 34.0368L90.1005 9.89946C95.5679 4.43212 104.432 4.43211 109.9 9.89945L134.037 34.0368C139.504 39.5042 139.504 48.3685 134.037 53.8358L109.9 77.9732Z" fill="${FONT_COLOR}"/>
        </svg>`,
        `<svg viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path fill-rule="evenodd" clip-rule="evenodd" d="M199.06 140.014C199.605 145.51 195.075 150 189.552 150H153.302C147.779 150 143.42 145.463 142.173 140.083C137.681 120.698 120.304 106.25 99.5522 106.25C78.8007 106.25 61.4237 120.698 56.931 140.083C55.6841 145.463 51.325 150 45.8022 150H9.55217C4.02932 150 -0.500355 145.51 0.0445342 140.014C5.0553 89.4741 47.6939 50 99.5522 50C151.41 50 194.049 89.4741 199.06 140.014Z" fill="${FONT_COLOR}"/>
        </svg>`,
        `<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M100 22C100 9.84974 90.1503 0 78 0H22C9.84974 0 0 9.84972 0 22V78.7194C0 90.8697 9.84974 100.719 22 100.719H78C90.1503 100.719 100 110.569 100 122.719V178C100 190.15 109.85 200 122 200H178C190.15 200 200 190.15 200 178V121.28C200 109.13 190.15 99.2805 178 99.2805H122C109.85 99.2805 100 89.4308 100 77.2805V22Z" fill="${FONT_COLOR}"/>
       </svg>
        `,
        `<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M99.995 200V143.969L0 99.995H56.0313L99.995 0V56.0313L200 99.995H143.969L99.995 200Z" fill="${FONT_COLOR}"/>
        </svg>        
        `,
        `<svg width="200" height="200" viewBox="0 0 200 200" fill="none" xmlns="http://www.w3.org/2000/svg">
        <g clip-path="url(#clip0_119_333)">
        <path fill-rule="evenodd" clip-rule="evenodd" d="M82.0191 130.784C28.1506 223.072 171.923 223.072 117.981 130.784C200.122 223.072 223.074 200.161 130.779 117.986C223.074 171.856 223.074 28.0777 130.779 82.0224C223.074 -0.153397 200.153 -23.0746 117.981 69.2237C171.849 -23.0746 28.0766 -23.0746 82.0191 69.2237C-0.153358 -23.0746 -23.0737 -0.153397 69.221 82.0224C-23.0737 28.1517 -23.0737 171.93 69.221 117.986C-23.0737 200.161 -0.153358 223.072 82.0191 130.784ZM100 125C113.807 125 125 113.807 125 100C125 86.1929 113.807 75 100 75C86.1929 75 75 86.1929 75 100C75 113.807 86.1929 125 100 125Z" fill="${FONT_COLOR}"/>
        </g>
        </svg> 
        `
    ];
    const _svg = DATA_SVG[(req.query.name.charCodeAt(1) + req.query.name.charCodeAt(0)) % DATA_SVG.length]

    const width = 500 // width of the image
    const height = 500 // height of the image
    const canvas = createCanvas(width, height);

    const context = canvas.getContext('2d')

    context.beginPath();
    // context.fillStyle = '#93C5FD';
    context.fillStyle = 'transparent';
    context.arc(250, 250, 240, 0, 2 * Math.PI);
    context.fill();

    var gradient = context.createRadialGradient(250, 250, 240, 0, 0, 2 * Math.PI);

    gradient.addColorStop(.5, HSLja);
    gradient.addColorStop(1, HSLja);

    context.fillStyle = gradient;
    context.arc(250, 250, 240, 0, 2 * Math.PI);
    context.fill();

    context.beginPath();
    context.lineWidth = 14;
    context.arc(250, 250, 240, 0, 2 * Math.PI);
    context.strokeStyle = '#fff';
    context.stroke();
    // context.drawImage(svgElement, 125, 125, 250, 250);

    context.font = 'bold 130px "Inter"';
    context.textAlign = 'center';
    context.textBaseline = 'middle';
    context.fillStyle = FONT_COLOR;
    if (req.query.style === 'initials') {
        context.fillText(name || 'LM', 250, 250);
        res.end(canvas.toBuffer("image/png"));
        return;
    }

    res.writeHead(
        200,
        {
            "Content-Type": "image/png",
        }
    );

    const decoded = Buffer.from(_svg).toString('base64');

    const _url = `data:image/svg+xml;base64,${decoded}=` 

    const img = new Image()
    const _num = 700;
    var scale = Math.min(width / _num, height / _num);
    var w = (_num/2) * scale;
    var h = (_num/2) * scale;
    var left = width / 2 - w / 2;
    var top = height / 2 - h / 2;
    console.log(HSLja);
    img.onload = function() {
        context.drawImage(img, left, top, w, h); 
        res.end(canvas.toBuffer("image/png"));
    }
    img.src = _url;
    // img.src = 'data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBhcmlhLWhpZGRlbj0idHJ1ZSIgcm9sZT0iaW1nIiBjbGFzcz0iaWNvbmlmeSBpY29uaWZ5LS1waCIgd2lkdGg9IjFlbSIgaGVpZ2h0PSIxZW0iIHByZXNlcnZlQXNwZWN0UmF0aW89InhNaWRZTWlkIG1lZXQiIHZpZXdCb3g9IjAgMCAyNTYgMjU2Ij48cGF0aCBmaWxsPSJjdXJyZW50Q29sb3IiIGQ9Ik0xNTYgMTY0YTcyIDcyIDAgMSAwLTY4LjQtOTQuNkE1MC40IDUwLjQgMCAwIDAgNzYgNjhhNDggNDggMCAwIDAgMCA5Nmg0Ni44bC0yMi4xIDMzLjhhMy44IDMuOCAwIDAgMC0uMiA0LjFhMy45IDMuOSAwIDAgMCAzLjUgMi4xaDQyLjhsLTIyLjEgMzMuOGEzLjkgMy45IDAgMCAwIDEuMSA1LjVhMy42IDMuNiAwIDAgMCAyLjIuN2EzLjggMy44IDAgMCAwIDMuMy0xLjhsMjYuMy00MGE0IDQgMCAwIDAgLjItNC4xYTQuMSA0LjEgMCAwIDAtMy42LTIuMWgtNDIuOGwyMS0zMlpNMzYgMTE2YTQwIDQwIDAgMCAxIDQwLTQwYTQzLjMgNDMuMyAwIDAgMSA5LjUgMS4xQTczLjEgNzMuMSAwIDAgMCA4NCA5MmE0IDQgMCAwIDAgOCAwYTY0IDY0IDAgMSAxIDY0IDY0SDc2YTQwIDQwIDAgMCAxLTQwLTQwWiI+PC9wYXRoPjwvc3ZnPg==';
})

app.listen(3000)